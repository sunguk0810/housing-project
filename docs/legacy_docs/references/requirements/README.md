# 요구사항 리서치 프롬프트 — 실행 가이드

> **용도**: `request_prompt_pack.md`에 포함된 6개 프롬프트를 어떤 순서로 실행하고, 결과를 어떻게 연결하는지 안내합니다.
> **총 라운드**: 4회 (병렬 가능 구간 포함)
> **선행 조건**: 디자인 리서치 완료 → `design_brief.md` 산출물 확보

---

## 의존성 다이어그램

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│   [1단계 — 병렬 가능]                                            │
│   ┌──────────────────────┐  ┌──────────────────────┐            │
│   │ 프롬프트 1            │  │ 프롬프트 2            │            │
│   │ 요구사항 추출          │  │ 충돌/모호성/누락      │            │
│   │ (FR / NFR / Policy)  │  │ 갭 분석              │            │
│   └──────────┬───────────┘  └──────────┬───────────┘            │
│              │                         │                        │
│              │  ※ P2는 P1 결과 있으면    │                        │
│              │    더 정밀하지만,          │                        │
│              │    원본 문서만으로도       │                        │
│              │    독립 실행 가능          │                        │
│              └────────────┬────────────┘                        │
│                           │ 두 결과 합류                         │
│                           ▼                                     │
│   [2단계 — 병렬 가능]                                            │
│   ┌──────────────────────┐  ┌──────────────────────┐            │
│   │ 프롬프트 3            │  │ 프롬프트 4            │            │
│   │ User Story +         │  │ 이벤트/지표 명세      │            │
│   │ Acceptance Criteria  │  │ (Gate 고정)          │            │
│   └──────────┬───────────┘  └──────────┬───────────┘            │
│              │                         │                        │
│              └────────────┬────────────┘                        │
│                           ▼                                     │
│   [3단계 — 순차]                                                 │
│   ┌──────────────────────────────────┐                          │
│   │ 프롬프트 5                        │                          │
│   │ 컴플라이언스 매핑                  │                          │
│   │ (출시 게이트 분리)                 │                          │
│   └──────────────────┬───────────────┘                          │
│                      │                                          │
│                      ▼                                          │
│   [4단계 — 순차, 최종]                                           │
│   ┌──────────────────────────────────┐                          │
│   │ 프롬프트 6                        │                          │
│   │ 최종 통합                         │                          │
│   │ (Requirements Baseline)          │                          │
│   └──────────────────────────────────┘                          │
│   산출물: requirements_baseline.md                               │
│   (이 문서 + design_brief.md = MVP 개발의 양대 참조 문서)         │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 단계별 실행 가이드

### 1단계: 요구사항 추출 + 갭 분석 (병렬 가능)

두 프롬프트를 **동시에** 별도 세션에서 실행할 수 있습니다.
둘 다 동일한 공통 입력 문서(기본 세트)를 참조합니다.

| 프롬프트 | 영역 | 컨텍스트 인풋 | 산출물 |
|---------|------|-------------|--------|
| **P1** | 요구사항 추출 (FR/NFR/Policy) | 공통 입력 문서 기본 세트 | `requirements_extraction.md` |
| **P2** | 충돌/모호성/누락 갭 분석 | 공통 입력 문서 기본 세트 + (P1 결과, 있다면) | `requirements_gap.md` |

**병렬 실행 시 주의사항**:
- P2는 P1 산출물(`requirements_extraction.md`)을 **선택 인풋**으로 받습니다.
- P1 없이 원본 문서만으로 P2를 실행해도 80% 이상의 결과를 얻을 수 있습니다.
- 단, **정밀도를 최대화**하려면 P1 → P2 순차 실행을 권장합니다.

**토큰 제한 시 우선 투입 문서** (3개):
1. `step3_preflight_check.md` — KPI 게이트와 검증 기준의 원천
2. `step3_readiness_adjudication.md` — 판정 결과와 조건부 통과 사항
3. `design_brief.md` — 기능 범위와 UI 요구사항의 원천

**소요 시간**: 각 15~20분 (병렬이면 총 20분, 순차 시 ~35분)

---

### 2단계: User Story + 이벤트 명세 (병렬 가능)

두 프롬프트를 **동시에** 실행할 수 있습니다.
둘 다 1단계 결과를 참조하지만 서로 간 의존성은 없습니다.

| 프롬프트 | 영역 | 컨텍스트 인풋 | 산출물 |
|---------|------|-------------|--------|
| **P3** | User Story + AC (P0 중심) | P1 + P2 결과, `design_brief.md`, `step4_mvp_plan.md` | `requirements_story_ac.md` |
| **P4** | 이벤트/지표 명세 (Gate 고정) | P1 결과, `step3_preflight_check.md`, `step3_readiness_adjudication.md`, `step4_mvp_plan.md` | `requirements_events.md` |

**투입 방법**: 각 프롬프트에 1단계 산출물을 추가

P3의 경우:
```
## 선행 산출물

### 요구사항 추출 결과 (P1)
[requirements_extraction.md 전문 또는 Executive Summary + FR 테이블]

### 갭 분석 결과 (P2)
[requirements_gap.md 전문 또는 Executive Summary + Conflict/Ambiguity Log]
```

P4의 경우:
```
## 선행 산출물

### 요구사항 추출 결과 (P1)
[requirements_extraction.md의 Executive Summary + FR/NFR 테이블]
```

> **⚠️ 토큰 절약 팁**: P1/P2 결과 전문이 길면, **Executive Summary + 핵심 테이블(P0 항목만)**을 추출하여 투입하세요. P3은 P0 요구사항에 집중하므로 P1/P2의 전체 목록이 꼭 필요하진 않습니다.

**소요 시간**: 각 15~20분 (병렬이면 총 20분)

---

### 3단계: 컴플라이언스 매핑 (순차)

P3(User Story + AC)가 완료되어야 실행할 수 있습니다.
Story ID 기반으로 컴플라이언스를 매핑하기 때문입니다.

| 항목 | 내용 |
|------|------|
| **실행** | 프롬프트 5 |
| **방식** | 순차 — 2단계 P3 완료 후 |
| **컨텍스트 인풋** | `requirements_story_ac.md` + 법적 문서 3종 |
| **산출물** | `requirements_compliance.md` |
| **소요 시간** | 약 15~20분 |

**필수 법적 문서 3종**:
1. `step0_legal_compliance.md`
2. `legal_compliance_adjudication.md`
3. `step3_readiness_adjudication.md`

**투입 방법**: 프롬프트 5에 다음을 추가
```
## 선행 산출물

### User Story + AC (P3 결과)
[requirements_story_ac.md 전문]
```

> **⚠️ 이 단계를 건너뛰지 마세요**: 컴플라이언스 매핑 없이 P6(최종 통합)을 실행하면 Production/Portfolio 게이트 판정이 불완전해집니다.

---

### 4단계: 최종 통합 — Requirements Baseline (순차)

모든 선행 산출물을 하나로 종합합니다. **이 단계는 새로운 분석이 아니라 통합·판정 작업**입니다.

| 항목 | 내용 |
|------|------|
| **실행** | 프롬프트 6 |
| **방식** | 순차 — 3단계 완료 후 |
| **컨텍스트 인풋** | **P1~P5 산출물 전체** + `step3_preflight_check.md` + `step4_mvp_plan.md` |
| **산출물** | `requirements_baseline.md` — 개발팀 실행용 단일 베이스라인 |
| **소요 시간** | 약 15~20분 |

**투입 방법**: 프롬프트 6에 P1~P5 산출물을 투입
```
## 입력 산출물
[requirements_extraction.md 붙여넣기]
[requirements_gap.md 붙여넣기]
[requirements_story_ac.md 붙여넣기]
[requirements_events.md 붙여넣기]
[requirements_compliance.md 붙여넣기]
```

> **⚠️ 토큰 절약 팁**: 5개 문서 전문이 컨텍스트를 초과하면, 각 문서의 **Executive Summary + 핵심 테이블만** 추출하여 투입하세요. P6 프롬프트는 새로운 요구사항을 발굴하지 않으므로 결론과 판정 데이터만 있으면 충분합니다. 우선순위: P5(컴플라이언스) > P1(FR/NFR) > P3(Story AC) > P4(이벤트) > P2(갭)

---

## 한눈에 보는 실행 타임라인

```
시간 ──────────────────────────────────────────────────────────────▶

[1단계]  ██████████████████    ██████████████████
         P1 요구사항 추출       P2 갭 분석
         (동시 실행 가능)       (동시 실행 가능)
              │                      │
              └──────────┬───────────┘
                         │ 합류
                         ▼
[2단계]       ██████████████████    ██████████████████
              P3 User Story + AC    P4 이벤트/지표 명세
              (동시 실행)           (동시 실행)
                    │                     │
                    └──────────┬──────────┘
                               ▼
[3단계]                 ██████████████████
                        P5 컴플라이언스 매핑
                               │
                               ▼
[4단계]                 ██████████████████
                        P6 최종 통합
                        (Requirements Baseline)

최적 소요: 약 70~80분 (순차 실행 시 ~120분 대비 약 40% 절약)
```

---

## 산출물 체크리스트

| # | 산출물 | 프롬프트 | 파일명 | 완료 |
|---|--------|---------|--------|------|
| 1 | 요구사항 추출 (FR/NFR/Policy 목록) | P1 | `requirements_extraction.md` | ☐ |
| 2 | 충돌/모호성/누락 갭 분석 | P2 | `requirements_gap.md` | ☐ |
| 3 | User Story + Acceptance Criteria | P3 | `requirements_story_ac.md` | ☐ |
| 4 | 이벤트/지표 명세 (Gate 고정) | P4 | `requirements_events.md` | ☐ |
| 5 | 컴플라이언스 매핑 + 출시 게이트 | P5 | `requirements_compliance.md` | ☐ |
| **6** | **Requirements Baseline (최종 통합)** | **P6** | **`requirements_baseline.md`** | ☐ |

---

## 보강 권장사항

아래는 현재 프롬프트 팩을 더 견고하게 만들기 위한 개선 포인트입니다.

### 보강 1: P2 → P1 순차 강제 고려

현재 P1/P2가 "병렬 가능"으로 표기되어 있지만, **P2의 정밀도는 P1 결과에 크게 의존**합니다. P2의 "Missing Requirements Top 10"은 P1의 FR/NFR 목록이 있어야 빠진 것을 찾을 수 있기 때문입니다.

**권장**: 시간 여유가 있다면 P1 → P2 순차를 기본으로 하고, 병렬은 시간 압박 시 대안으로 안내.

### 보강 2: Traceability Matrix 추가 (P6 또는 별도 P6.5)

현재 P6(최종 통합)에서 `Adjudicated Baseline Requirements` 테이블이 있지만, **FR → Story → AC → Event → Compliance 간 추적성 매트릭스**가 명시적으로 없습니다.

**권장**: P6 출력에 다음 섹션을 추가:
```markdown
### Traceability Matrix
| FR ID | Story ID | AC 수 | 관련 이벤트 | Compliance 상태 | 비고 |
|---|---|---|---|---|---|
```

이렇게 하면 "이 요구사항이 어떤 Story로 구현되고, 어떤 이벤트로 측정되며, 컴플라이언스가 충족되었는지"를 한 줄로 확인할 수 있습니다.

### 보강 3: 셀프 체크 프롬프트 추가

각 단계 산출물의 품질을 **자체 검증**하는 짧은 후속 프롬프트를 추가하면 오류 전파를 줄일 수 있습니다.

**권장**: 각 산출물 완료 후 다음을 실행:
```markdown
방금 작성한 [산출물명]을 다시 읽고, 다음을 점검하세요:
1. 모든 P0 항목에 [source]가 있는가?
2. [가정] 표시가 누락된 문서 외 판단이 있는가?
3. 테스트 불가능한 요구사항("~해야 한다" 형식이 아닌 것)이 있는가?
4. Production 기준과 Portfolio Override 기준이 혼재된 항목이 있는가?
   발견된 문제를 수정하고, 수정 내역을 마지막에 기록하세요.
```

### 보강 4: P3/P4 교차 검증 단계

P3(User Story)과 P4(이벤트)를 병렬로 실행하면, **Story의 AC와 이벤트 트리거가 불일치**할 수 있습니다.

**권장**: 2단계 완료 후, P6 전에 간단한 교차 검증을 추가:
```markdown
P3(requirements_story_ac.md)의 각 P0 AC에 대해,
P4(requirements_events.md)의 Event Dictionary에서 해당 AC를 검증할 이벤트가 존재하는지 확인하세요.
매핑되지 않는 AC나 이벤트가 있다면 목록으로 출력하세요.
```

### 보강 5: 롤백 가이드

특정 단계에서 심각한 문제(예: P5에서 법적 블로커 발견)가 발생했을 때 **어느 단계까지 되돌아가야 하는지** 명시하면 좋습니다.

| 발견 시점 | 문제 유형 | 롤백 대상 |
|-----------|----------|----------|
| P2 갭 분석 | P0 범위 충돌 발견 | P1 재실행 (범위 조정 반영) |
| P3 Story 작성 | 모호성 해소 불가 | P2 갭 분석 업데이트 → P1 재검토 |
| P5 컴플라이언스 | 법적 블로커 발견 | P3 Story AC 수정 → P5 재실행 |
| P6 통합 | Gate 수치 불일치 | P4 이벤트 명세 수정 → P6 재실행 |

### 보강 6: Design Brief 연동 명시

현재 프롬프트 팩은 `design_brief.md`를 입력 문서로 참조하지만, **디자인 리서치와 요구사항 리서치 간의 관계**가 명시적이지 않습니다.

**권장**: README 상단에 다음을 추가:
```
## 전체 프로세스에서의 위치
디자인 리서치 (P1~P8) → design_brief.md
                              ↓ (입력)
요구사항 리서치 (P1~P6) → requirements_baseline.md
                              ↓ (두 문서를 함께)
Step4 MVP 개발 착수
```

---

## 주의사항

- **P1/P2를 동시에 실행할 때**: P2에 P1 결과가 없으면 "Missing Requirements Top 10"의 정밀도가 낮아집니다. 시간이 허락하면 P1 → P2 순차를 권장합니다.
- **P5(컴플라이언스)를 빼먹지 마세요**: P6에서 Production/Portfolio 게이트 판정을 내리려면 P5 결과가 필수입니다. P5 없이 P6을 실행하면 판정이 불완전해집니다.
- **[가정] 태그를 반드시 확인하세요**: 산출물에 [가정]이 많다면 입력 문서가 부족한 신호입니다. 보강 문서(`step2_summary.md`, `step2_experiment_plan.md`)를 추가 투입하세요.
- **Production vs Portfolio 분리 확인**: 매 단계 산출물에서 두 기준이 혼재되어 있지 않은지 반드시 점검하세요. 혼재 시 P6 판정에서 혼란이 발생합니다.
- **P6은 새로운 분석이 아닙니다**: P1~P5가 모두 끝난 뒤에만 실행하세요. 새로운 요구사항을 발굴하는 게 아니라 기존 결과를 통합·판정하는 작업입니다.
- **파일명을 통일하세요**: 산출물 파일명을 프롬프트 팩에 명시된 대로 고정하면 후속 프롬프트의 컨텍스트 투입이 간편해집니다.

---

## 디자인 리서치와의 관계

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│   [디자인 리서치]                                                │
│   P1~P8 → design_brief.md                                      │
│                │                                                │
│                ▼ (입력 문서로 투입)                               │
│   [요구사항 리서치]                                              │
│   P1~P6 → requirements_baseline.md                              │
│                │                                                │
│                ▼                                                 │
│   ┌──────────────────────────────────────────────────┐          │
│   │ Step4 MVP 개발                                    │          │
│   │ 참조 문서:                                        │          │
│   │   1. requirements_baseline.md (무엇을/어떻게)     │          │
│   │   2. design_brief.md (어떤 모습으로)              │          │
│   └──────────────────────────────────────────────────┘          │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 반복 실행 시 버전 관리

| 상황 | 방법 |
|------|------|
| P0 범위 변경으로 재실행 | 파일명 뒤에 `_v2`, `_v3` 추가 (예: `requirements_extraction_v2.md`) |
| 특정 프롬프트만 재실행 | 변경된 산출물의 버전을 올리고, 후속 프롬프트에 최신 버전을 투입 |
| 전체 재실행 | 이전 버전 폴더(`v1/`)로 이동 후 새로 시작 |
| 변경 추적 | P6 산출물의 `Decision Log`에 변경 사유와 이전 버전 참조를 기록 |